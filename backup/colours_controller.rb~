require 'net/http'
require 'date'
require 'will_paginate/array'

class ColoursController < ApplicationController

  before_filter :find_colour, :only => [:show, :update]

  def index
    limit = params[:limit].nil? ? Settings.api.default_result_limit : params[:limit].to_i
    colours = Colour.find(:all).paginate(:page => params[:page], :per_page => limit)
    colours = add_footer_info_to_json_paginate(colours)
    render :json => colours, :status => :ok
  end

  def show
    render :json => @colour, :status => :ok
  end
  
  def new
    json = { 
      :name  => "",
      :rgb => ""
    }.to_json
    render :json => json, :status => :ok
  end
  
  def update
    if @colour.update_attributes params[:colour]
      head :no_content 
    else
      head :not_modified
    end
  end

  def create
    @colour = Colour.new params[:colour]
    if @colour.save
      head :created, :location => colour_path(@colour)
    else
     render :json => { :message => "Invalid document parameters (#{params[:name]}, #{params[:rgb]}). ",
       :request => request.fullpath }, 
        :status => :unprocessable_entity         
    end
  end

private
  def find_colour
    @colour = Colour.find(params[:id])
  end

end

